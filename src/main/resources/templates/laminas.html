<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8" />
	<title th:text="'Láminas de ' + ${album.nombre}">Láminas</title>
	<link rel="stylesheet" href="/css/login.css?v=2" />
</head>
<body>
<div class="page-bg">
	<main class="login-wrapper">
		<header class="login-header">
			<div class="logo">Co-Lections</div>
			<h1 th:text="'Láminas de ' + ${album.nombre}">Láminas</h1>
		</header>

		<section class="card album-list">


			<div class="bottom-actions">
				<p>
					<a th:href="@{'/vista/albumes/' + ${album.id}}" class="btn-link">
						<svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
						<span>Volver al álbum</span>
					</a>
				</p>
				<a class="btn-danger" href="/auth/logout" onclick="localStorage.removeItem('jwtToken');">
					<svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M16 13V11H8V8L3 12L8 16V13H16Z"/></svg>
					<span class="action-label">Cerrar sesión</span>
				</a>
			</div>

			<!-- If album declares a total, render sequence 1..N with either the added lamina or a placeholder -->
			<div th:if="${album.cantidadTotalLaminas != null and album.cantidadTotalLaminas > 0}">
				<div class="lamina-grid">
					<div class="lamina-card" th:each="i : ${#numbers.sequence(1, album.cantidadTotalLaminas)}">
						<div th:if="${laminaMapa[i] != null}">
							<div class="thumb">
								<img th:src="${laminaMapa[i].urlFoto != null ? laminaMapa[i].urlFoto : '/images/placeholder.svg'}" alt="foto lámina" />
							</div>
							<div class="lamina-meta">
								<span class="numero" th:text="${i}"></span>
								<span class="tipo" th:text="${laminaMapa[i].tipo != null ? laminaMapa[i].tipo : 'Lámina'}"></span>
							</div>
						</div>
						<div th:if="${laminaMapa[i] == null}">
							<div class="thumb no-photo">
								<span class="no-photo-text">aún no añadida</span>
							</div>
							<div class="lamina-meta">
								<span class="numero" th:text="${i}"></span>
								<span class="tipo">-</span>
							</div>
						</div>
					</div>
					<div class="lamina-card add-card">
						<a th:href="@{'/vista/albumes/' + ${album.id} + '/laminas/nueva'}" class="btn-primary">Agregar nueva</a>
					</div>
				</div>
			</div>
			<!-- If album has no declared total, render only the actual laminas (existing) -->
			<div th:if="${album.cantidadTotalLaminas == null or album.cantidadTotalLaminas <= 0}">
				<div th:if="${laminas == null or #lists.isEmpty(laminas)}" style="text-align:center; padding:2rem 0;">
					<a th:href="@{'/vista/albumes/' + ${album.id} + '/laminas/nueva'}" class="btn-primary">Agregar nueva</a>
				</div>
				<div th:if="${!(laminas == null or #lists.isEmpty(laminas))}" class="lamina-grid">
					<div class="lamina-card" th:each="lamina : ${laminas}">
						<div class="thumb">
							<img th:src="${lamina.urlFoto != null ? lamina.urlFoto : '/images/placeholder.svg'}" alt="foto lámina" />
						</div>
						<div class="lamina-meta">
							<span class="numero" th:text="${lamina.numero}"></span>
							<span class="tipo" th:text="${lamina.tipo != null ? lamina.tipo : 'Lámina'}"></span>
						</div>
					</div>
					<div class="lamina-card add-card">
						<a th:href="@{'/vista/albumes/' + ${album.id} + '/laminas/nueva'}" class="btn-primary">Agregar nueva</a>
					</div>
				</div>
			</div>
		</section>

		<footer class="footer">
			<div class="stamp-left"></div>
			<div class="stamp-right"></div>
		</footer>
	</main>
</div>
</body>
</html>
